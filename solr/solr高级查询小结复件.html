<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/305825 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="591"/>

<div>
<span><div><span><font style="font-size: 16pt;"><b>1.概述</b></font></span></div><div><span><font style="font-size: 16pt;"><b><br/></b></font></span></div><div><span>   <span>    <span>    </span></span> <font style="font-size: 12pt;">最近项目中频繁的使用到solr进行数据分析和统计,solr的高级查询功能,facet,stats,group在此小结下solr的高级查询。</font></span></div><div><span><font style="font-size: 12pt;"><br/></font></span></div><div><span><font style="font-size: 16pt;"><b>2.stats 查询</b></font></span></div><div><span><font style="font-size: 16pt;"><b><br/></b></font></span></div><div><span><font><span style="font-size: 14pt;">  </span> <font style="font-size: 12pt;"> <span>    <span> </span></span><span style="color: rgb(0, 0, 0); letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font>Solr可以利用StatsComponent 实现数据库的聚合统计查询，也就是min、max、avg、count、sum的功能，方便直观的统计一个字段或者多个字段在整个数据集的中总数，最大值，最小值等等信息。</font></span></font></font><span style="font-size: 12pt; line-height: 1.45; orphans: 2; widows: 2;"> </span></span></div><div><br/></div><div><div><font style="font-size: 11pt;">请求参数说明：</font></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 280px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;">参数</div></td><td style="text-align: center; border: 1px solid rgb(204, 204, 204); width: 280px; padding: 8px;">说明</td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">stats</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 280px; padding: 8px;"><div style="text-align: center;"><div><span style="font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; line-height: 1.45; orphans: 2; widows: 2;">是否开启stats（true/false）</span></div></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">stats.field</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 280px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">添加一个字段来统计，可以有多个</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">stats.facet </span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 280px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">在给定的面返回值的子结果。</span></div></td></tr></tbody></table><div><span style="font-size: 11pt;">返回参数说明：</span></div></div><div><br/></div><div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 281px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">返回字段</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">字段含义</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">min</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">最小值</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">max</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">最大值</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">sum</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">总和</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">count</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">记录数，也就是多少行记录</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">missing</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">结果集中，有多少条记录是空值</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">sumOfSquares</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">平方和（x1^2 + x2^2+xn^2）</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">mean</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"> 平均数（x1+x2+xn）/n</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">stddev</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 281px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">标准差</span></div></td></tr></tbody></table><div><br/></div></div><div><br/></div><div><font style="font-size: 12pt;"><b>网页控制台查询方式</b>:</font></div><div><br/></div><div><img src="solr高级查询小结复件_files/ds.png" type="image/png" data-filename="ds.png"/></div><div><br/></div><div><span><font style="color: rgb(255, 0, 0);">注意：1 .<span>    </span>一定要有rows=0,不然就会查询结果集而不是进行统计。</font></span></div><div><span><font style="color: rgb(255, 0, 0);">          2.<span>     </span>统计的字段要是数字类型的。</font></span></div><div><br/></div><div><span style="font-size: 12pt;"><b>java查询方式</b>:</span></div><div><span style="font-size: 12pt;"><span>    </span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">private</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">FieldStatsInfo statistics(String params,String field) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         CloudSolrClient client =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">appClient</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">.getInstance(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">zkHost</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">,</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">collection</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         SolrQuery query =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">new</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">SolrQuery();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         QueryResponse response =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         FieldStatsInfo result =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">try</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">{</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;q&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, params);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;stats&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">,</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;true&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;indent&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">,</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;true&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;rows&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">,</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;0&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;stats.field&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, field);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             response = client.query(query);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">if</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(response !=</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 Map&lt;String, FieldStatsInfo&gt; fieldStatsInfos = response.getFieldStatsInfo();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">for</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(Map.Entry&lt;String, FieldStatsInfo&gt; entry : fieldStatsInfos.entrySet()) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                      String key = entry.getKey();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                      FieldStatsInfo fieldStatsInfo = entry.getValue();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                      </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">if</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(field.equals(key)) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                          result = fieldStatsInfo;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                          </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">break</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                      }</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 }</span></div><div style="min-height: 17pt;"></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             }</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         }</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">catch</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(Exception e) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">logger</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">.info(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;综合查询solr查询报错&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, e);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         }</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">return</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">result;</span></div><div><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">    }</span></div></div><div><span style="font-size: 12pt;"><span>    </span></span></div><div><font size="4">   </font> <font style="font-size: 12pt;">对于多字段进行统计，修改方法参数field为集合方式。stats统计的查询接收参数是 <span style="min-height: 17pt; font-family: Consolas; color: rgb(51, 51, 51);">Map&lt;String, FieldStatsInfo&gt;,solrj api封装了相关方法进行操作。<span style="min-height: 17pt; font-family: Consolas; color: rgb(51, 51, 51);">FieldStatsInfo对象可以对统计的结果集进行操作，取最大值，最小值，总数等等。</span></span></font></div><div><br/></div><div><span style="color: rgb(51, 51, 51);"><font style="font-size: 16pt;"><b>3.Facet 查询</b></font></span></div><div><span style="color: rgb(51, 51, 51);"><font><span style="font-size: 14pt;"> </span> <font style="font-size: 12pt;">  facet 查询方便对一个或多个字段在不同区间的变化进行统计，常见的电商网站的品牌，地域，型号等参数统计等。facet统计查询要设置facet=true或者facet=on,</font></font></span></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 18px; line-height: 23px;">    最简单的facet查询：facet=true&amp;facet.field=attribution&amp;rows=0,查询按地域各个地域的数据</span></div><div><br/></div><div><br/></div><div><font style="color: rgb(51, 51, 51); font-size: 18px;"><span style="line-height: 23px;"><img src="solr高级查询小结复件_files/微信截图_20170811164402.png" type="image/png" data-filename="微信截图_20170811164402.png"/></span></font></div><div><br/></div><div><br/></div><div><span style="color: rgb(51, 51, 51); font-size: 18px; line-height: 23px;">过滤prefix查询：<span style="color: rgb(51, 51, 51); font-size: 18px; line-height: 23px;">facet=true&amp;facet.field=attribution<span style="font-size: 14pt; color: rgb(51, 51, 51);">&amp;facet.prefix=湖&amp;</span>rows=0,查询按地域各个地域的数据只查询以湖子开头的省份</span></span></div><div><br/></div><div><span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    <span>    </span></span></span></span></span></span></span></span></span></span></span></span></span></span> <img src="solr高级查询小结复件_files/ss.png" type="image/png" data-filename="ss.png" style="font-family: monospace; font-size: 14pt; color: rgb(51, 51, 51);"/></div><div><font style="font-size: 11pt;">facet 参数说明：</font></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 198px;"></col><col style="width: 406px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;">字段</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;">说明</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.prefix</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">限制constaints的前缀</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.mincount</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">限制constants count的最小返回值，默认为0</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.sort</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">排序的方式，根据count或者index</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.offset</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">表示在当前排序情况下的偏移，可以做分页</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.limit</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">constraints返回的数目</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.missing</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">是否返回没有值的field</span></div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 198px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">facet.query</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 406px; padding: 8px;"><div style="text-align: center;"><span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">可以对任意的字段进行筛选，例如筛选时间段数据</span></div></td></tr></tbody></table><div style="text-align: center;"><div><br/></div></div></div><div><font style="font-size: 12pt;">由于项目中时间字段格式存储的不是solr的data类型,暂且没有用到 <span style="color: rgb(0, 0, 0); font-family: Helvetica, Tahoma, Arial, sans-serif; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">Date Facet 类型统计,待以后用到再做补充。</span></font></div><div><br/></div><div style="orphans: 2; widows: 2;"><font face="Helvetica, Tahoma, Arial, sans-serif" size="4"><span style="line-height: 23px;">java 操作facet查询</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">/**</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     * 按字段的值进行分组统计</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     *</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     *</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 159, 191); font-size: 15pt; font-weight: bold;">@param</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">params</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     *</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 159, 191); font-size: 15pt; font-weight: bold;">@param</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">fields</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     *</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 159, 191); font-size: 15pt; font-weight: bold;">@return</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 95, 191); font-size: 15pt;">     */</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">    </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">private</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">List&lt;FacetField&gt; getFacetFields(String params, String[] fields) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         CloudSolrClient client =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">appClient</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">.getInstance(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">zkHost</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">,</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">collection</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         SolrQuery query =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">new</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">SolrQuery();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         QueryResponse response =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">int</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">length = fields.</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">length</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">try</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">{</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.set(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;q&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, params);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.setFacet(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">true</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.setRows(0);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             query.setFacetMinCount(1);</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(63, 127, 95); font-size: 15pt;">// 设置返回的数据中每个分组的数据最小值，比如设置为0，则统计数量最小为0，不然不显示</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">for</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">int</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">i = 0; i &lt; length; i++) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 query.addFacetField(fields[i]);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             }</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             response = client.query(query);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             List&lt;FacetField&gt; facetFields = response.getFacetFields();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">return</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">facetFields;</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         }</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">catch</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(Exception e) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(0, 0, 192); font-size: 15pt;">logger</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">.info(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;综合查询solr查询报错&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, e);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         }</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">return</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">;</span></div><div><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);"><span>    <span>    <span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; background: #e8f2fe; color: rgb(51, 51, 51);">List&lt;FacetField&gt; typeFacetFields = getFacetFields(params,</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; background: #e8f2fe; font-weight: bold;">new</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; background: #e8f2fe; color: rgb(51, 51, 51);">String[]{</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt; background: #e8f2fe;">&quot;attribution&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; background: #e8f2fe; color: rgb(51, 51, 51);">});</span></span></span></span></span></div><div><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);"><span>         <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">List&lt;Map&lt;String, Object&gt;&gt; list =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">new</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">ArrayList&lt;Map&lt;String, Object&gt;&gt;();</span></span></span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">if</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(typeFacetFields !=</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">null</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">&amp;&amp; typeFacetFields.size() == 1) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             FacetField facetField = typeFacetFields.get(0);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             List&lt;Count&gt; valueCounts = facetField.getValues();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">for</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">(Count count : valueCounts) {</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 </span><span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">long</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">startNum = count.getCount();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 String province = count.getName();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 Map&lt;String, Object&gt; startDistribution =</span> <span style="min-height: 17pt; font-family: Consolas; color: rgb(127, 0, 85); font-size: 15pt; font-weight: bold;">new</span> <span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">HashMap&lt;String, Object&gt;();</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 startDistribution.put(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;name&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, province);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 startDistribution.put(</span><span style="min-height: 17pt; font-family: Consolas; color: rgb(42, 0, 255); font-size: 15pt;">&quot;value&quot;</span><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">, startNum);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">                 list.add(startDistribution);</span></div><div style="min-height: 17pt;"><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">             }</span></div><div><span style="min-height: 17pt; font-family: Consolas; font-size: 15pt; color: rgb(51, 51, 51);">         }</span></div></div><div><span>    </span></div><div><font style="font-size: 12pt;">solrJ 对于facet统计和返回对象为<span style="min-height: 17pt; font-family: Consolas; color: rgb(51, 51, 51); background-color: rgb(232, 242, 254); background-position: initial initial; background-repeat: initial initial;">List&lt;FacetField&gt;,此出是对单字段进行facet统计。如若多字段，解析结果代码需要重写。</span></font></div><div><br/></div><div><br/></div></span>
</div></body></html> 